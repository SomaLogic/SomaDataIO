<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Pre-Process an ADAT Object for Analysis — preProcessAdat • SomaDataIO</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pre-Process an ADAT Object for Analysis — preProcessAdat"><meta name="description" content="Pre-process an ADAT file containing raw analyte RFU values in preparation
for analysis. For more details please refer to the pre-processing how-to article"><meta property="og:description" content="Pre-process an ADAT file containing raw analyte RFU values in preparation
for analysis. For more details please refer to the pre-processing how-to article"><meta property="og:image" content="https://somalogic.github.io/SomaDataIO/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SomaDataIO</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">6.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/SomaDataIO.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/tips-loading-and-wrangling.html">Loading and Wrangling 'SomaScan'</a></li>
    <li><a class="dropdown-item" href="../articles/tips-safely-map-values.html">Safely Map Values via dplyr::left_join()</a></li>
    <li><a class="dropdown-item" href="../articles/tips-safely-rename-df.html">Safely Rename Data Frames</a></li>
    <li><a class="dropdown-item" href="../articles/tips-train-test-setup.html">Common train-test data setups</a></li>
    <li><a class="dropdown-item" href="../articles/cli-merge-tool.html">Command Line Merge Tool</a></li>
    <li><a class="dropdown-item" href="../articles/lifting-and-bridging.html">Lifting and Bridging SomaScan</a></li>
    <li><a class="dropdown-item" href="../articles/pre-processing.html">Pre-Processing SomaScan</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-workflows" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Workflows</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-workflows"><li><h6 class="dropdown-header" data-toc-skip>Difference Testing</h6></li>
    <li><a class="dropdown-item" href="../articles/stat-two-group-comparison.html">Two-Group Comparison</a></li>
    <li><a class="dropdown-item" href="../articles/stat-three-group-analysis-anova.html">ANOVA Three-Group Analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Making Predictions</h6></li>
    <li><a class="dropdown-item" href="../articles/stat-binary-classification.html">Binary Classification</a></li>
    <li><a class="dropdown-item" href="../articles/stat-linear-regression.html">Linear Regression</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-coming-soon" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Coming Soon</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-coming-soon"><li><h6 class="dropdown-header" data-toc-skip>SomaScan FAQs</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Standard Process</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>Best Practices</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Non-Standard Matrices</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>Limits of Detection (LoD)</h6></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SomaLogic/SomaDataIO/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Pre-Process an ADAT Object for Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/SomaLogic/SomaDataIO/blob/main/R/preProcessAdat.R" class="external-link"><code>R/preProcessAdat.R</code></a></small>
      <div class="d-none name"><code>preProcessAdat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Pre-process an ADAT file containing raw analyte RFU values in preparation
for analysis. For more details please refer to the <a href="https://somalogic.github.io/SomaDataIO/articles/pre-processing.html">pre-processing how-to article</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">preProcessAdat</span><span class="op">(</span></span>
<span>  <span class="va">adat</span>,</span>
<span>  filter.features <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  filter.controls <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  filter.qc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  filter.outliers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  data.qc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  log.10 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  center.scale <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-adat">adat<a class="anchor" aria-label="anchor" href="#arg-adat"></a></dt>
<dd><p>A <code>soma_adat</code> object created using <code><a href="read_adat.html">read_adat()</a></code>, including
SeqId columns (<code>seq.xxxxx.xx</code>) containing raw RFU values.</p></dd>


<dt id="arg-filter-features">filter.features<a class="anchor" aria-label="anchor" href="#arg-filter-features"></a></dt>
<dd><p>Logical. Should non-human protein features (SeqIds) be
dropped? Default is <code>TRUE</code>.</p></dd>


<dt id="arg-filter-controls">filter.controls<a class="anchor" aria-label="anchor" href="#arg-filter-controls"></a></dt>
<dd><p>Logical. Should SomaScan technical control samples
be dropped? If <code>TRUE</code>, this retains all samples where <code>SampleType = "Sample"</code>
(study samples) and discards all others including buffer, calibrator, and
QC control samples. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-filter-qc">filter.qc<a class="anchor" aria-label="anchor" href="#arg-filter-qc"></a></dt>
<dd><p>Logical. If <code>TRUE</code> only samples that pass default
normalization acceptance criteria will be retained. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-filter-outliers">filter.outliers<a class="anchor" aria-label="anchor" href="#arg-filter-outliers"></a></dt>
<dd><p>Logical. Should the <code>adat</code> object drop outlier
samples? An outlier sample is defined by &gt;= 5% of filtered SeqIds exceeding
+/- 6 MAD and 5x fold-change from the median signal. This filter is typically
appropriate for studies on plasma, serum, and other biological matrices
generally exhibiting homeostatic characteristics. For studies on matrices
such as tissue homogenate, cell culture, or study designs containing
client-provided background lysis buffer controls (or similar), this filter
will likely not be appropriate. Default is <code>FALSE</code>. If set to <code>TRUE</code>
it is highly recommended that <code>filter.controls</code> is also set to <code>TRUE</code></p></dd>


<dt id="arg-data-qc">data.qc<a class="anchor" aria-label="anchor" href="#arg-data-qc"></a></dt>
<dd><p>Character. Character vector of variable names for which data
QC plots are desired. Default is <code>NULL</code>, which does not generate any QC
plots.  Note: These plots are for visual inspection only, no samples or
features are dropped from the output <code>soma_adat</code> object.</p></dd>


<dt id="arg-log-">log.10<a class="anchor" aria-label="anchor" href="#arg-log-"></a></dt>
<dd><p>Logical. Should the RFU values be log10 transformed?
Default is <code>FALSE</code>.</p></dd>


<dt id="arg-center-scale">center.scale<a class="anchor" aria-label="anchor" href="#arg-center-scale"></a></dt>
<dd><p>Logical. Should the RFU values be Z-transformed
(centered and scaled)? Default is <code>FALSE</code>. If set to set to <code>TRUE</code>
it is highly recommended that <code>log.10</code> is also set to <code>TRUE</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>soma_adat</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>soma_adat</code> object is pre-processed with the following steps:</p><ol><li><p>Filter features -&gt; down to human protein analytes</p></li>
<li><p>Filter samples -&gt; by the following order and criteria:
a) Retain study samples only (dropping buffer, calibrator, and QC samples)
b) Only those that pass default normalization acceptance criteria
c) Those not identified as outliers.</p></li>
<li><p>Data QC -&gt; plots of normalization scale factors by clinical covariates</p></li>
<li><p>Transformations -&gt; log10, center, and scale analyte RFU values</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Caleb Scheidel</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">preProcessAdat</span><span class="op">(</span><span class="va">example_data</span>, data.qc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"Sex"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">305</span> non-human protein features were removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → <span style="color: #0000BB;">214</span> human proteins did not pass standard QC</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> acceptance criteria and were flagged in `ColCheck`.  These features</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> were not removed, as they still may yield useful information in an</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> analysis, but further evaluation may be needed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">6</span> buffer samples were removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">10</span> calibrator samples were removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">6</span> QC samples were removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">2</span> samples flagged in `RowCheck` did not</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> pass standard normalization acceptance criteria (0.4 &lt;= x &lt;= 2.5)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> and were removed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → Data QC plots were generated:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Age</span>
<span class="r-plt img"><img src="preProcessAdat-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Sex</span>
<span class="r-plt img"><img src="preProcessAdat-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">══</span> <span style="font-weight: bold;">SomaScan Data</span> <span style="color: #0000BB;">══════════════════════════════════════════════════════</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      SomaScan version     <span style="color: #00BBBB;">V4 (5k)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Signal Space         <span style="color: #00BBBB;">5k</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Attributes intact    <span style="color: #00BB00;">✓</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Rows                 <span style="color: #00BBBB;">168</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Columns              <span style="color: #00BBBB;">5013</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Clinical Data        <span style="color: #00BBBB;">34</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Features             <span style="color: #00BBBB;">4979</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB;">──</span> <span style="font-weight: bold;">Column Meta</span> <span style="color: #BB00BB;">────────────────────────────────────────────────────────</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> SeqId, SeqIdVersion, SomaId, TargetFullName, Target,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> UniProt, EntrezGeneID, EntrezGeneSymbol, Organism, Units,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Type, Dilution, PlateScale_Reference, CalReference,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Cal_Example_Adat_Set001, ColCheck,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> CalQcRatio_Example_Adat_Set001_170255, QcReference_170255,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Cal_Example_Adat_Set002,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> CalQcRatio_Example_Adat_Set002_170255, Dilution2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB;">──</span> <span style="font-weight: bold;">Tibble</span> <span style="color: #BB00BB;">─────────────────────────────────────────────────────────────</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 168 × 5,014</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    row_names      PlateId  PlateRunDate ScannerID PlatePosition SlideId</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 258495800012_3 Example… 2020-06-18   SG152144… H9            2.58<span style="color: #949494;">e</span>11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 258495800004_7 Example… 2020-06-18   SG152144… H8            2.58<span style="color: #949494;">e</span>11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 258495800010_8 Example… 2020-06-18   SG152144… H7            2.58<span style="color: #949494;">e</span>11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 258495800003_4 Example… 2020-06-18   SG152144… H6            2.58<span style="color: #949494;">e</span>11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 258495800009_4 Example… 2020-06-18   SG152144… H5            2.58<span style="color: #949494;">e</span>11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 258495800012_8 Example… 2020-06-18   SG152144… H4            2.58<span style="color: #949494;">e</span>11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 258495800001_3 Example… 2020-06-18   SG152144… H3            2.58<span style="color: #949494;">e</span>11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 258495800004_8 Example… 2020-06-18   SG152144… H2            2.58<span style="color: #949494;">e</span>11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 258495800001_8 Example… 2020-06-18   SG152144… H12           2.58<span style="color: #949494;">e</span>11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 258495800009_8 Example… 2020-06-18   SG152144… H10           2.58<span style="color: #949494;">e</span>11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 158 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 5,008 more variables: Subarray &lt;dbl&gt;, SampleId &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   SampleType &lt;chr&gt;, PercentDilution &lt;int&gt;, SampleMatrix &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Barcode &lt;lgl&gt;, Barcode2d &lt;chr&gt;, SampleName &lt;lgl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   SampleNotes &lt;lgl&gt;, AliquotingNotes &lt;lgl&gt;, …</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">═══════════════════════════════════════════════════════════════════════</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p><img src="../favicon-16x16.png"> SomaDataIO was developed by the Bioinformatics Dept. at <a href="http://www.standardbio.com" class="external-link">Standard BioTools, Inc.</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

  </div></footer></body></html>

