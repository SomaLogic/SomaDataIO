<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lifting and Bridging SomaScan • SomaDataIO</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Lifting and Bridging SomaScan">
<meta name="description" content="A primer on lifting and bridging 'SomaScan' data.
">
<meta property="og:description" content="A primer on lifting and bridging 'SomaScan' data.
">
<meta property="og:image" content="https://somalogic.github.io/SomaDataIO/logo.png">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SomaDataIO</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">6.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/SomaDataIO.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/tips-loading-and-wrangling.html">Loading and Wrangling 'SomaScan'</a></li>
    <li><a class="dropdown-item" href="../articles/tips-safely-map-values.html">Safely Map Values via dplyr::left_join()</a></li>
    <li><a class="dropdown-item" href="../articles/tips-safely-rename-df.html">Safely Rename Data Frames</a></li>
    <li><a class="dropdown-item" href="../articles/tips-train-test-setup.html">Common train-test data setups</a></li>
    <li><a class="dropdown-item" href="../articles/cli-merge-tool.html">Command Line Merge Tool</a></li>
    <li><a class="dropdown-item" href="../articles/lifting-and-bridging.html">Lifting and Bridging SomaScan</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-workflows" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Workflows</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-workflows">
<li><h6 class="dropdown-header" data-toc-skip>Difference Testing</h6></li>
    <li><a class="dropdown-item" href="../articles/stat-two-group-comparison.html">Two-Group Comparison</a></li>
    <li><a class="dropdown-item" href="../articles/stat-three-group-analysis-anova.html">ANOVA Three-Group Analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Making Predictions</h6></li>
    <li><a class="dropdown-item" href="../articles/stat-binary-classification.html">Binary Classification</a></li>
    <li><a class="dropdown-item" href="../articles/stat-linear-regression.html">Linear Regression</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-coming-soon" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Coming Soon</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-coming-soon">
<li><h6 class="dropdown-header" data-toc-skip>SomaScan FAQs</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Standard Process</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>Best Practices</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Non-Standard Matrices</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>Limits of Detection (LoD)</h6></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SomaLogic/SomaDataIO/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Lifting and Bridging SomaScan</h1>
                        <h4 data-toc-skip class="author">Stu Field,
Standard BioTools, Inc.</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SomaLogic/SomaDataIO/blob/main/vignettes/articles/lifting-and-bridging.Rmd" class="external-link"><code>vignettes/articles/lifting-and-bridging.Rmd</code></a></small>
      <div class="d-none name"><code>lifting-and-bridging.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><code>SomaDataIO</code> contains functionality to bridge (aka “lift”)
between various SomaScan versions by linear transformations of RFU data.
Lifting between various versions is essentially a calibration of the
analytes/features in RFU space.</p>
<div class="section level3">
<h3 id="why-lift">Why lift?<a class="anchor" aria-label="anchor" href="#why-lift"></a>
</h3>
<p>The SomaScan platform continually improves its technical processes
between assay versions. The primary change of interest is content
expansion, and other protocol changes may be implemented including:
changing reagents, liquid handling equipment, and well volumes.</p>
<p>For any given analyte, these technical upgrades may result in minute
measurement signal differences, requiring a calibration (aka “lifting”
or “bridging”) to bring RFU values into a comparable signal space. This
is accomplished by applying an analyte-specific scalar, a linear
transformation, to each analyte RFU measurement (column).</p>
<div class="section level4">
<h4 id="current-somascan-versions">Current SomaScan Versions<a class="anchor" aria-label="anchor" href="#current-somascan-versions"></a>
</h4>
<table class="table">
<thead><tr class="header">
<th align="left"><strong>Version</strong></th>
<th align="center"><strong>Commercial Name</strong></th>
<th align="right"><strong>Size</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>V4</code></td>
<td align="center">5k</td>
<td align="right">5284</td>
</tr>
<tr class="even">
<td align="left"><code>v4.1</code></td>
<td align="center">7k</td>
<td align="right">7596</td>
</tr>
<tr class="odd">
<td align="left"><code>v5.0</code></td>
<td align="center">11k</td>
<td align="right">11083</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="lifting-requirements">Lifting Requirements<a class="anchor" aria-label="anchor" href="#lifting-requirements"></a>
</h4>
<p>There are 4 main requirements in order to reliably bridge across
SomaScan signal space:</p>
<ol style="list-style-type: decimal">
<li>the <code>soma_adat</code> object attributes, where SomaScan signal
information is stored, must be intact (see
<code><a href="../reference/is_intact_attr.html">is_intact_attr()</a></code>).</li>
<li>the sample matrix must be either human serum or human EDTA-plasma.
No other matrices are currently supported. Additionally, bridging must
<em>not</em> be applied across matrices (i.e. serum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>↔</mo><annotation encoding="application/x-tex">\leftrightarrow</annotation></semantics></math>
plasma).</li>
<li>the RFU data must have been normalized by Adaptive Normalization via
Maximum-Likelihood (ANML). This is the standard normalization for most
SomaScan deliveries.</li>
<li>the current SomaScan version and signal space must be one of those
above (see table), i.e. one of <code>5k</code>, <code>7k</code>, or
<code>11k</code>. Older versions of SomaScan are not supported.</li>
</ol>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="lifting-scalars">Lifting Scalars<a class="anchor" aria-label="anchor" href="#lifting-scalars"></a>
</h3>
<p>Lifting (aka “bridging”) scalars are numeric values used to multiply
a vector of RFU values to linearly transform them into another signal
space.</p>
<p>Lifting scalars are generated from matched samples (n
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>&gt;</mo><annotation encoding="application/x-tex">&gt;</annotation></semantics></math>
1000) from a healthy, normal reference population were run across assay
versions. This experiment was run separately for both serum and plasma
and all SomaScan runs were first normalized as per the standard
normalization procedure, and flagged samples were removed prior to
further analysis.</p>
<p>For each analyte, the lifting scalar is computed as the ratio of
population <em>medians</em> between assay versions. For example, the
linear scalar for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">i^{th}</annotation></semantics></math>
analyte translating from <code>11k</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>→</mo><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math><code>7k</code> is defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>i</mi></msub><mo>=</mo><mfrac><msub><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mrow><mn>7</mn><mi>k</mi></mrow></msub><msub><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mrow><mn>11</mn><mi>k</mi></mrow></msub></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
R_i = \frac{\hat\mu_{7k}}{\hat\mu_{11k}},
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>μ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat\mu</annotation></semantics></math>
is the <em>median</em> signal for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">i^{th}</annotation></semantics></math>
analyte. Signals generated in <code>11k</code> space can be multiplied
by this scale factor to translate into <code>7k</code> space.</p>
<p>Below is a concordance plot of what this shift would look like for a
single analyte on a <em>simulated</em> reference population. Please see
the section below on Lin’s CCC for its definition and
interpretation.</p>
<div class="figure">
<img src="figures%2Flifting-lift-concord-1.png" alt="Figure 1. Signal concordance for a single analyte pre- and post-lifting." width="576"><p class="caption">
Figure 1. Signal concordance for a single analyte pre- and post-lifting.
</p>
</div>
<hr>
</div>
<div class="section level3">
<h3 id="lifting-concordance">Lifting Concordance<a class="anchor" aria-label="anchor" href="#lifting-concordance"></a>
</h3>
<p>Measurements generated from the matched samples used to calculate the
lifting scalars were also used to calculate the post-hoc Lin’s
Concordance Correlation Coefficient (CCC) estimates of the SomaScan
bridge.</p>
<p>Lin’s CCC is calculated by computing the correlation between
post-lift RFU values and the RFU values generated on the original
SomaScan version, and is defined by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>C</mi><mi>C</mi><mo>=</mo><mfrac><mrow><mn>2</mn><mi>ρ</mi><msub><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>x</mi></msub><msub><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>y</mi></msub></mrow><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mi>x</mi></msub><mo>−</mo><msub><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mi>y</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msubsup><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>x</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>y</mi><mn>2</mn></msubsup></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
CCC = \frac{2\rho\hat\sigma_x\hat\sigma_y}{(\hat\mu_x - \hat\mu_y)^2 + \hat\sigma^2_x + \hat\sigma^2_y},
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>μ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat\mu</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>σ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat\sigma</annotation></semantics></math>
are the Pearson correlation coefficient, and the estimated mean and
standard deviation from assay version groups <em>x</em> and <em>y</em>
respectively.</p>
<div class="section level4">
<h4 id="interpretation-of-ccc">Interpretation of CCC<a class="anchor" aria-label="anchor" href="#interpretation-of-ccc"></a>
</h4>
<p>Lin’s CCC was chosen to evaluate lifting performance because it is
characterized not only by correlation (Pearson’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>),
but also accounts for deviation from the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">y = x</annotation></semantics></math>
unit line (diagonal). CCC range is in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[-1, 1]</annotation></semantics></math>
and can be viewed as an estimate of the confidence in the bridging
transformation (in normal reference samples) across SomaScan versions.
Examples of factors that could affect lifting CCC are:</p>
<ul>
<li>analytes/reagents with high intra-assay CV (Coefficient of
Variation)</li>
<li>analytes/reagents signaling near background or saturation
levels</li>
</ul>
</div>
<div class="section level4">
<h4 id="accessing-ccc">Accessing CCC<a class="anchor" aria-label="anchor" href="#accessing-ccc"></a>
</h4>
<p>The <code><a href="../reference/adat-helpers.html">getSomaScanLiftCCC()</a></code> function retrieves these values
from an internal object for either <code>"serum"</code> and
<code>"plasma"</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plasma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adat-helpers.html">getSomaScanLiftCCC</a></span><span class="op">(</span><span class="st">"p"</span><span class="op">)</span></span>
<span><span class="va">plasma</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11,083 × 4</span></span></span>
<span><span class="co">#&gt;    SeqId    plasma_11k_to_5k_ccc plasma_11k_to_7k_ccc plasma_7k_to_5k_ccc</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 10000-28                0.966                0.982               0.963</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 10001-7                 0.86                 0.961               0.875</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 10003-15                0.674                0.787               0.668</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 10006-25                0.864                0.927               0.877</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 10008-43                0.879                0.939               0.908</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 10010-10               <span style="color: #BB0000;">NA</span>                    0.915              <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 10011-65                0.642                0.784               0.743</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 10012-5                 0.528                0.661               0.591</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 10013-34                0.76                 0.824               0.744</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10014-31                0.934                0.971               0.941</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 11,073 more rows</span></span></span>
<span></span>
<span><span class="va">serum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adat-helpers.html">getSomaScanLiftCCC</a></span><span class="op">(</span><span class="st">"s"</span><span class="op">)</span></span>
<span><span class="va">serum</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11,083 × 4</span></span></span>
<span><span class="co">#&gt;    SeqId    serum_11k_to_5k_ccc serum_11k_to_7k_ccc serum_7k_to_5k_ccc</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 10000-28               0.97                0.977              0.967</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 10001-7                0.819               0.857              0.875</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 10003-15               0.761               0.759              0.774</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 10006-25               0.903               0.937              0.937</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 10008-43               0.915               0.951              0.925</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 10010-10              <span style="color: #BB0000;">NA</span>                   0.895             <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 10011-65               0.515               0.748              0.741</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 10012-5                0.57                0.717              0.716</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 10013-34               0.716               0.86               0.778</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10014-31               0.906               0.951              0.913</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 11,073 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdf_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  ccc    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">plasma</span><span class="op">$</span><span class="va">plasma_11k_to_7k_ccc</span>, <span class="va">serum</span><span class="op">$</span><span class="va">serum_11k_to_7k_ccc</span><span class="op">)</span>,</span>
<span>  matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"plasma"</span>, <span class="st">"serum"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">plasma</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">cdf_df</span> <span class="op">&lt;-</span> <span class="va">cdf_df</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cdf_df</span><span class="op">$</span><span class="va">ccc</span><span class="op">)</span>, <span class="op">]</span>   <span class="co"># rm NAs; non-comparable analytes</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cdf_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">ccc</span>, colour <span class="op">=</span> <span class="va">matrix</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_ecdf</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_colour_manual</span><span class="op">(</span>name <span class="op">=</span> <span class="st">""</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#00A499"</span>, <span class="st">"#24135F"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"CDF of CCC Values"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Lin's CCC (11k -&gt; 7k)"</span>, y <span class="op">=</span> <span class="st">"P(X &lt; x)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures%2Flifting-cdf-ccc-1.png" alt="Figure 2. Cumulative distribution function of CCC values for the 11k -&gt; 7k lift." width="576"><p class="caption">
Figure 2. Cumulative distribution function of CCC values for the 11k
-&gt; 7k lift.
</p>
</div>
<p>As shown in distribution above, for the <code>11k</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>→</mo><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math><code>7k</code> lift, post-bridging CCC values above 0.75 (considered
high quality) are approximately 88% and 84% of the SomaScan menu for
plasma and serum respectively. In fact, characterizing CCC lifting
quality into 3 categories (Low, Medium, High) yields the table
below:</p>
<table class="table">
<caption>Table 1. The proportion of the SomaScan menu split into 3
categories by CCC.</caption>
<thead><tr class="header">
<th align="left">Matrix</th>
<th align="right">Low [0, 0.5)</th>
<th align="right">Medium [0.5, 0.75)</th>
<th align="right">High [0.75, 1]</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Plasma</td>
<td align="right">0.024</td>
<td align="right">0.096</td>
<td align="right">0.880</td>
</tr>
<tr class="even">
<td align="left">Serum</td>
<td align="right">0.035</td>
<td align="right">0.124</td>
<td align="right">0.841</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="somascan-analyte-setdiff">SomaScan Analyte Setdiff<a class="anchor" aria-label="anchor" href="#somascan-analyte-setdiff"></a>
</h3>
<p>For any given bridge, there is a common, intersecting subset of
analytes between SomaScan versions. Non-intersecting analytes will be
either missing or added in the new signal space. As a result, bridging
data across SomaScan may involve either skipping analytes (columns) or
scaling by 1.0. <code>SomaDataIO</code> has internal checks that trigger
warnings if these conditions are met.</p>
<p>There are two scenarios to consider:</p>
<ul>
<li>Newer versions of SomaScan typically have additional content,
i.e. new reagents added to the multi-plex assay that bind to additional
proteins. When lifting <em>to</em> a previous SomaScan version, new
reagents that do <em>not</em> exist in the “earlier” assay version assay
are scaled by 1.0, and thus are maintained, unmodified in the returned
object. Downstream analysis may require removing these columns in order
to combine these data with a previous study from an earlier SomaScan
version, e.g. with <code><a href="../reference/loadAdatsAsList.html">collapseAdats()</a></code>.</li>
<li>In the inverse scenario, lifting “forward” <em>from</em> a previous,
lower-plex version, there will be extra reference values that are
unnecessary to perform the lift, and a warning is triggered. The
resulting data consists of RFU data in the “new” signal space, but with
fewer analytes than would otherwise be expected (e.g. <code>11k</code>
space with only 5284 analytes; see example below).</li>
</ul>
<hr>
</div>
<div class="section level3">
<h3 id="example-5k-rightarrow-11k">Example: <code>5k</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>→</mo><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math><code>11k</code><a class="anchor" aria-label="anchor" href="#example-5k-rightarrow-11k"></a>
</h3>
<p>Since <code>example_data</code> object was originally run on SomaScan
V4, this vignette will demonstrate the lifting/bridging process
<em>from</em> a <code>5k</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>→</mo><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math><code>11k</code> signal space, the most recent SomaScan version.</p>
<div class="section level4">
<h4 id="steps">Steps<a class="anchor" aria-label="anchor" href="#steps"></a>
</h4>
<ol style="list-style-type: decimal">
<li>
<p>Determine that attributes are intact.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/is_intact_attr.html">is_intact_attr</a></span><span class="op">(</span><span class="va">adat</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p>Determine the matrix type of the data (serum or plasma).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">adat</span>, <span class="st">"Header.Meta"</span><span class="op">)</span><span class="op">$</span><span class="va">HEADER</span><span class="op">$</span><span class="va">StudyMatrix</span></span></code></pre></div>
</li>
<li>
<p>Ensure the current SomaScan signal space is lift-supported.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/adat-helpers.html">getSignalSpace</a></span><span class="op">(</span><span class="va">adat</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/adat-helpers.html">checkSomaScanVersion</a></span><span class="op">(</span><span class="fu"><a href="../reference/adat-helpers.html">getSignalSpace</a></span><span class="op">(</span><span class="va">adat</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p>Apply analyte-specific scalars to their corresponding columns via
<code><a href="../reference/lift_adat.html">lift_adat()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lift_adat.html">lift_adat</a></span><span class="op">(</span><span class="va">adat</span>, bridge <span class="op">=</span> <span class="st">"&lt;direction&gt;"</span><span class="op">)</span></span></code></pre></div>
<p>Current <code>bridge</code> options are: “11k_to_7k”, “11k_to_5k”,
“7k_to_11k”, “7k_to_5k”, “5k_to_11k”, “5k_to_7k”.</p>
</li>
</ol>
</div>
<div class="section level4">
<h4 id="step-1">Step 1<a class="anchor" aria-label="anchor" href="#step-1"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># determine intact attributes</span></span>
<span><span class="co"># must be TRUE</span></span>
<span><span class="fu"><a href="../reference/is_intact_attr.html">is_intact_attr</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-2">Step 2<a class="anchor" aria-label="anchor" href="#step-2"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># determine study matrix</span></span>
<span><span class="co"># must be Human Serum or EDTA-Plasma</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">example_data</span>, <span class="st">"Header.Meta"</span><span class="op">)</span><span class="op">$</span><span class="va">HEADER</span><span class="op">$</span><span class="va">StudyMatrix</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "EDTA Plasma"</span></span></code></pre></div>
<p>Confirm that the matrix of the SomaScan run was
<code>"EDTA Plasma"</code>:</p>
</div>
<div class="section level4">
<h4 id="step-3">Step 3<a class="anchor" aria-label="anchor" href="#step-3"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># determine if current space can be lifted</span></span>
<span><span class="co"># must be V4, v4.1, or v5.0</span></span>
<span><span class="va">from_space</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adat-helpers.html">getSignalSpace</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">)</span></span>
<span><span class="va">from_space</span></span>
<span><span class="co">#&gt; [1] "V4"</span></span>
<span></span>
<span><span class="co"># must be NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="fu"><a href="../reference/adat-helpers.html">checkSomaScanVersion</a></span><span class="op">(</span><span class="va">from_space</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Finally, invoke <code><a href="../reference/lift_adat.html">lift_adat()</a></code> to perform the
bridge/transformation:</p>
</div>
<div class="section level4">
<h4 id="step-4">Step 4<a class="anchor" aria-label="anchor" href="#step-4"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lift_11k</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lift_adat.html">lift_adat</a></span><span class="op">(</span><span class="va">example_data</span>, bridge <span class="op">=</span> <span class="st">"5k_to_11k"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: There are extra scaling values (5799) in the reference.</span></span>
<span><span class="co">#&gt; They will be ignored.</span></span>
<span></span>
<span><span class="fu"><a href="../reference/lift_adat.html">is_lifted</a></span><span class="op">(</span><span class="va">lift_11k</span><span class="op">)</span>           <span class="co"># signal space was lifted</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="../reference/read_adat.html">is.soma_adat</a></span><span class="op">(</span><span class="va">lift_11k</span><span class="op">)</span>        <span class="co"># preserves 'soma_adat' class</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="../reference/adat-helpers.html">getSignalSpace</a></span><span class="op">(</span><span class="va">lift_11k</span><span class="op">)</span>      <span class="co"># current space</span></span>
<span><span class="co">#&gt; [1] "v5.0"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/adat-helpers.html">getSomaScanVersion</a></span><span class="op">(</span><span class="va">lift_11k</span><span class="op">)</span>  <span class="co"># original space</span></span>
<span><span class="co">#&gt; [1] "V4"</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="caveats-to-consider">Caveats to Consider<a class="anchor" aria-label="anchor" href="#caveats-to-consider"></a>
</h3>
<div class="section level4">
<h4 id="was-the-somascan-bridge-successful">Was the SomaScan bridge successful?<a class="anchor" aria-label="anchor" href="#was-the-somascan-bridge-successful"></a>
</h4>
<p>Lifting SomaScan involves a simple linear transformation of a numeric
vector (of RFU values), thus in one sense it will always be
“successful”. However, users often wish to know if this was the correct
course of action for their data.</p>
<p>From the concordance plot in <strong>Figure 1</strong>, we can see
that the transformation is <em>reducing</em> the <code>11k</code> RFU
brightness by ~19% in accordance with the median signal difference that
existed in the reference population (of healthy normals). Rare edge
cases aside, this is <em>usually</em> the desired outcome, otherwise
downstream analysis would be confounded by the uncorrected shift in
SomaScan space, and would likely result in significant differences
related to signal space rather than actual biology.</p>
</div>
<div class="section level4">
<h4 id="should-you-filter-analytes">Should you filter analytes?<a class="anchor" aria-label="anchor" href="#should-you-filter-analytes"></a>
</h4>
<p>Users often ask if certain analytes be should removed based on a
given CCC threshold <em>prior</em> to analysis. The issue of choosing an
appropriate threshold aside, unless there is prior knowledge justifying
removal, we do not recommend removing analytes based on CCC alone.</p>
<p>This advice stems from how the CCC values are initially calculated;
i.e. from a healthy, normal reference population sampled across two
versions of SomaScan. Recall that CCC is influenced by CV and thus
signaling range. For example, if a given analyte is near its limit of
detection in a healthy population, and therefore likely has a high(er)
CV, i.e. low CCC, removing this analyte may <em>not</em> be the desired
course of action in a disease population where that analyte could be
signaling in the linear range.</p>
<p>Therefore, we currently recommend careful evaluation on a case by
case basis using prior knowledge and orthogonal justification before
filtering analytes from discovery or exploratory analyses.</p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="questions">Questions<a class="anchor" aria-label="anchor" href="#questions"></a>
</h3>
<p>As always, if you have any bridging or lifting questions, we are here
to help. Please reach out to us via:</p>
<ul>
<li>via GitHub <a href="https://somalogic.github.io/SomaDataIO/SUPPORT.html">SUPPORT</a>
</li>
<li>Global Scientific Engagement Team: <a href="mailto:techsupport@somalogic.com" class="email">techsupport@somalogic.com</a>
</li>
<li>General SomaScan inquiries: <a href="mailto:support@somalogic.com" class="email">support@somalogic.com</a>
</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p><img src="../favicon-16x16.png"> SomaDataIO was developed by the Bioinformatics Dept. at <a href="http://www.standardbio.com" class="external-link">Standard BioTools, Inc.</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer>
</body>
</html>
