<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Pre-Processing SomaScan • SomaDataIO</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pre-Processing SomaScan">
<meta name="description" content="A primer on pre-processing 'SomaScan' data for analysis, including filtering samples and features, data QC, and transformations.
">
<meta property="og:description" content="A primer on pre-processing 'SomaScan' data for analysis, including filtering samples and features, data QC, and transformations.
">
<meta property="og:image" content="https://somalogic.github.io/SomaDataIO/logo.png">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SomaDataIO</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">6.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/SomaDataIO.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/tips-loading-and-wrangling.html">Loading and Wrangling 'SomaScan'</a></li>
    <li><a class="dropdown-item" href="../articles/tips-safely-map-values.html">Safely Map Values via dplyr::left_join()</a></li>
    <li><a class="dropdown-item" href="../articles/tips-safely-rename-df.html">Safely Rename Data Frames</a></li>
    <li><a class="dropdown-item" href="../articles/tips-train-test-setup.html">Common train-test data setups</a></li>
    <li><a class="dropdown-item" href="../articles/cli-merge-tool.html">Command Line Merge Tool</a></li>
    <li><a class="dropdown-item" href="../articles/lifting-and-bridging.html">Lifting and Bridging SomaScan</a></li>
    <li><a class="dropdown-item" href="../articles/pre-processing.html">Pre-Processing SomaScan</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-workflows" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Workflows</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-workflows">
<li><h6 class="dropdown-header" data-toc-skip>Difference Testing</h6></li>
    <li><a class="dropdown-item" href="../articles/stat-two-group-comparison.html">Two-Group Comparison</a></li>
    <li><a class="dropdown-item" href="../articles/stat-three-group-analysis-anova.html">ANOVA Three-Group Analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Making Predictions</h6></li>
    <li><a class="dropdown-item" href="../articles/stat-binary-classification.html">Binary Classification</a></li>
    <li><a class="dropdown-item" href="../articles/stat-linear-regression.html">Linear Regression</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-coming-soon" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Coming Soon</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-coming-soon">
<li><h6 class="dropdown-header" data-toc-skip>SomaScan FAQs</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Standard Process</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>Best Practices</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Non-Standard Matrices</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>Limits of Detection (LoD)</h6></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SomaLogic/SomaDataIO/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Pre-Processing SomaScan</h1>
                        <h4 data-toc-skip class="author">SomaScan
Bioinformatics Team, Standard BioTools, Inc.</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SomaLogic/SomaDataIO/blob/main/vignettes/articles/pre-processing.Rmd" class="external-link"><code>vignettes/articles/pre-processing.Rmd</code></a></small>
      <div class="d-none name"><code>pre-processing.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><code>SomaDataIO</code> contains functionality to prepare a SomaScan
.adat data file containing microarray-based relative fluorescent units
(RFUs) for analysis. The typical data analysis path includes several
steps of pre-processing, including:</p>
<ol style="list-style-type: decimal">
<li>Filtering features</li>
<li>Filtering samples</li>
<li>Data QC</li>
<li>Transformations</li>
</ol>
<p>This article will walk through <em>why</em> these pre-processing
steps are recommended prior to executing an analysis on SomaScan data,
along with <em>how</em> these steps can be performed using the
<code>SomaDataIO</code> package.</p>
<hr>
<div class="section level3">
<h3 id="section"></h3>
</div>
<div class="section level3">
<h3 id="filtering-features">Filtering Features<a class="anchor" aria-label="anchor" href="#filtering-features"></a>
</h3>
<p>The goal of this pre-processing step is to remove features (SeqIds)
typically not useful for analysis from a SomaScan dataset, while also
retaining <em>relevant</em> features that will enable broad discovery
during downstream analysis.</p>
<p>The filtering logic typically used for protein features (i.e. SOMAmer
Reagents) is:</p>
<pre><code><span><span class="va">Type</span> <span class="op">==</span> <span class="st">"Protein"</span> <span class="op">&amp;</span> <span class="va">Organism</span> <span class="op">==</span> <span class="st">"Human"</span></span></code></pre>
<p>What information does this logic convey? It indicates that only
<strong>human protein</strong> features from the raw SomaScan data set
should be retained. This can be accomplished by filtering on the ADAT
<code>Type</code> attribute, which represents the SOMAmer target type.
This will be used in conjunction with the <code>Organism</code>
attribute, which represents the organism from which the protein
originated.</p>
<p>These two attributes (<code>Type</code> and <code>Organism</code>)
can be accessed via <code><a href="../reference/getAnalyteInfo.html">SomaDataIO::getAnalyteInfo()</a></code>. This
function retrieves the analyte annotation data (i.e. the column
metadata, or <code>COL_DATA</code>) that appears above the protein
measurements in the ADAT file, and returns it in a
<code>data.frame</code> format.</p>
<p><em>Note: The <code>example_data</code> object used in this vignette
is a V4.0 plasma ADAT. Other matrices or versions of ADATs may contain
expanded feature sets. For more information about the format and content
of an ADAT, please</em> <em>reference the</em> <a href="https://github.com/SomaLogic/SomaLogic-Data" class="external-link">SomaLogic-Data</a>
<em>GitHub repository.</em></p>
<p>To retrieve the column metadata annotations for the data set:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getAnalyteInfo.html">getAnalyteInfo</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">)</span></span></code></pre></div>
<p>We can now check the contents of the <code>Type</code> and
<code>Organism</code> attributes, which can be accessed as columns of a
data frame once extracted with <code><a href="../reference/getAnalyteInfo.html">getAnalyteInfo()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annots</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Type</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 2</span></span></span>
<span><span class="co">#&gt;   Type                              n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Protein                        <span style="text-decoration: underline;">5</span>207</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Non-Human                        24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Spuriomer                        20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Hybridization Control Elution    12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Non-Biotin                       10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Deprecated                        7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> Non-cleavable                     4</span></span>
<span></span>
<span><span class="va">annots</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Organism</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14 × 2</span></span></span>
<span><span class="co">#&gt;    Organism                                                           n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Human                                                           <span style="text-decoration: underline;">5</span>032</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Mouse                                                            228</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Aequorea victoria (Jellyfish)                                      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> African clawed frog                                                3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Heloderma suspectum (Gila monster)                                 3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Hornet                                                             3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Thermus thermophilus                                               3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Photinus pyralis (North American firefly)                          2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Sambucus nigra (European elder)                                    2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Cyanidium caldarium                                                1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> Geobacillus stearothermophilus (Bacillus stearothermophilus)       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> Rhizobium meliloti (Ensifer meliloti) (Sinorhizobium meliloti)     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> isolate BEN                                                        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> isolate LW123                                                      1</span></span></code></pre></div>
<p>As described in the filtering strategy above, we only want to retain
the features for which <code>Type == "Protein"</code>, indicating that
the feature is related to a human protein. In the same filtering step,
we can also specify that we only want to retain proteins found in humans
(<code>Organism == "Human")</code>. In some versions of the assay there
are SeqIds labeled “Internal Use Only” which are not intended for
downstream analysis and can also be removed. This can be performed using
<code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">human_prots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getAnalyteInfo.html">getAnalyteInfo</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Type</span> <span class="op">==</span> <span class="st">"Protein"</span> <span class="op">&amp;</span> <span class="va">Organism</span> <span class="op">==</span> <span class="st">"Human"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^Internal Use Only"</span>, <span class="va">TargetFullName</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">human_prots</span><span class="op">$</span><span class="va">SeqId</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4979</span></span></code></pre></div>
<p>The original dataset (<code>example_adat</code>) contained 5284
analytes; after filtering for human proteins and removing 305 features
as described above, it contains 4979 analytes.</p>
<p>Remember that the <code>human_prots</code> object is not an ADAT, but
rather a <code>data.frame</code> representing the column metadata that
corresponds to the <code>example_data</code> ADAT object. We must now
filter the <code>example_data</code> object to match the filtering
performed on the <code>human_prots</code> object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identify SeqIds that differ between the data sets</span></span>
<span><span class="va">discard</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^seq\\."</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>                   <span class="va">human_prots</span><span class="op">$</span><span class="va">AptName</span><span class="op">)</span></span>
<span><span class="co"># Discard non-human, non-protein features</span></span>
<span><span class="va">filt_data</span> <span class="op">&lt;-</span> <span class="va">example_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu">all_of</span><span class="op">(</span><span class="va">discard</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This data set now contains only human proteins.</p>
<div class="section level4">
<h4 id="flagged-features">Flagged Features<a class="anchor" aria-label="anchor" href="#flagged-features"></a>
</h4>
<p>Our human protein analyte annotations object <code>human_prots</code>
contains a single column, called <code>ColCheck</code>, that can be used
for filtering flagged features from ADAT datasets. This column contains
the QC acceptance criteria for all plates/sets. The standard QC
acceptance criteria used to determine if a feature is flagged is if the
QC ratio by plate (aggregate across all plates) is within the acceptance
range of 0.8 to 1.2:</p>
<p><img src="figures%2Fpre-processing-img1-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Again, please see <a href="https://github.com/SomaLogic/SomaLogic-Data" class="external-link">SomaLogic-Data</a>
for more details.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">human_prots</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">ColCheck</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   ColCheck     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> FLAG       214</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> PASS      <span style="text-decoration: underline;">4</span>765</span></span></code></pre></div>
<p>214 human protein features in <code>filt_data</code> were flagged in
this column check, and are marked with a <code>FLAG</code> value. The
presence of a <code>FLAG</code> value indicates the SeqId for one of the
QC control samples was outside the range shown above on at least one
plate. The total number of SeqIds outside this range can be used to
assess potential issues with runs or studies, however a
<code>FLAG</code> value does not necessarily indicate a problem with the
signal for a specific analyte in the study samples. Therefore, these
features <strong>should not</strong> be filtered out of the dataset as
part of standard pre-processing.</p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="filtering-samples">Filtering Samples<a class="anchor" aria-label="anchor" href="#filtering-samples"></a>
</h3>
<p>The next pre-processing step to consider is filtering samples. A
typical data analysis is focused on only the study samples within the
ADAT file. The <code>SampleType</code> column in the
<code>filt_data</code> object can be used to filter down to the study
samples only.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filt_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">SampleType</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   SampleType     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Buffer         6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Calibrator    10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> QC             6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Sample       170</span></span></code></pre></div>
<p>An ADAT file will also include buffer, calibrator and QC samples. It
is recommended to remove these samples prior to an analysis.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filt_data</span> <span class="op">&lt;-</span> <span class="va">filt_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SampleType</span> <span class="op">==</span> <span class="st">"Sample"</span><span class="op">)</span></span></code></pre></div>
<p>The <code>filt_data</code> object now has 170 study samples, after
removing the 10 calibrator samples (replicate controls for combining
data across runs), 6 QC samples (replicate controls used to assess run
quality), and 6 buffer samples (no protein controls).</p>
<div class="section level4">
<h4 id="flagged-samples">Flagged Samples<a class="anchor" aria-label="anchor" href="#flagged-samples"></a>
</h4>
<p>An ADAT file contains a single column, called <code>RowCheck</code>,
that can be used for filtering out flagged samples that do not pass a
pre-defined normalization acceptance criteria.</p>
<p>The standard normalization acceptance criteria used to determine if a
sample is flagged by the <code>RowCheck</code> column is if <em>any</em>
of the <em>rowwise</em> normalization scale factors are outside of the
acceptance range of 0.4 to 2.5:</p>
<p><img src="figures%2Fpre-processing-img2-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filt_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">RowCheck</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>percent <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   RowCheck     n percent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> FLAG         2    1.18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> PASS       168   98.8</span></span></code></pre></div>
<p>Note 2 samples in <code>filt_data</code> are flagged with this row
check, and are marked with a <code>FLAG</code> value.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pull normalization scale factor variable names from ADAT</span></span>
<span><span class="va">norm_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^[Nn]orm[Ss]cale|^Med\\.Scale\\."</span>, </span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">filt_data</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">filt_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">RowCheck</span> <span class="op">==</span> <span class="st">"PASS"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">SampleId</span>, <span class="fu">all_of</span><span class="op">(</span><span class="va">norm_vars</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                SampleId NormScale_20 NormScale_0_005 NormScale_0_5</span></span>
<span><span class="co">#&gt; 258495800110_3      126    0.3700948        1.064435     0.9836240</span></span>
<span><span class="co">#&gt; 258495800109_1      147    0.2891420        1.111629     0.9634776</span></span></code></pre></div>
<p>We can see that these samples each have a normalization scale factor
from at least one dilution bin that fall below the standard accepted
range. Filtering samples based on the default <code>RowCheck</code>
column will drop these samples from <code>filt_data</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filt_data</span> <span class="op">&lt;-</span> <span class="va">filt_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">RowCheck</span> <span class="op">==</span> <span class="st">"PASS"</span><span class="op">)</span></span></code></pre></div>
<p>Note that normalization to a reference may result in scaling bias in
certain scenarios. It is recommended to check the flag rate using the
default acceptance criteria from <code>RowCheck</code>, and if &gt; 10%
of samples are flagged, further evaluation may be needed.</p>
<p>Depending on your data and experiment, it may be reasonable to keep
samples with <code>FLAG</code> values, particularly those samples close
to the acceptance criteria boundary. The <code>FLAG</code> value
indicates non-conformance to a reference (either study-specific or
external such as ANML), and further evaluation is encouraged to assess
if those samples should be considered true outliers for a given study
and removed.</p>
</div>
<div class="section level4">
<h4 id="sample-level-outliers-by-rfu">Sample Level Outliers by RFU<a class="anchor" aria-label="anchor" href="#sample-level-outliers-by-rfu"></a>
</h4>
<p>It is also important to evaluate if there are any sample-level
outliers by RFU measurements. For standard plasma and serum studies
Standard Biotools’ recommended outlier definition is any sample where
<code>&gt;= 5%</code> of RFU measurements exceed 6 median absolute
deviations (MADs) and 5x fold-change from median signal.</p>
<p>This filter is typically appropriate for studies on plasma, serum,
and other biological matrices generally exhibiting homeostatic
characteristics. For studies on matrices such as tissue homogenate, cell
culture, or study designs containing client-provided background lysis
buffer controls (or similar), this filter will likely not be
appropriate.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filt_data does not have any outliers by default</span></span>
<span><span class="co"># create a "fake" outlier sample as an example</span></span>
<span><span class="va">apts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getAnalytes.html">getAnalytes</a></span><span class="op">(</span><span class="va">filt_data</span><span class="op">)</span></span>
<span><span class="va">filt_data</span><span class="op">[</span><span class="fl">12</span>, <span class="va">apts</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">600</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">filt_data</span><span class="op">[</span><span class="fl">12</span>, <span class="va">apts</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">600</span><span class="op">]</span><span class="op">]</span> <span class="op">*</span> <span class="fl">100</span>  <span class="co"># 600 apts ~ 12%</span></span></code></pre></div>
<p>We can identify plasma and serum outlier samples using this
definition with the <code><a href="../reference/calcOutlierMap.html">calcOutlierMap()</a></code> function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">om</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcOutlierMap.html">calcOutlierMap</a></span><span class="op">(</span><span class="va">filt_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">om</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures%2Fpre-processing-rfu-outliers-plot-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The one sample in <code>filt_data</code> that we modified in the
previous code chunk was identified as an outlier by RFU measurements
with the <code>*</code>.</p>
<p>The <code><a href="../reference/getOutlierIds.html">getOutlierIds()</a></code> function is useful for extracting
the sample IDs that were flagged as outliers in the plot. These sample
IDs should be investigated further and possibly considered for removal
prior to analysis.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rfu_outliers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getOutlierIds.html">getOutlierIds</a></span><span class="op">(</span><span class="va">om</span><span class="op">)</span></span>
<span><span class="va">rfu_outliers</span></span>
<span><span class="co">#&gt;   idx</span></span>
<span><span class="co">#&gt; 1  12</span></span>
<span></span>
<span><span class="co"># drop one outlier sample</span></span>
<span><span class="va">filt_data</span> <span class="op">&lt;-</span> <span class="va">filt_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">rfu_outliers</span><span class="op">$</span><span class="va">idx</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="data-qc">Data QC<a class="anchor" aria-label="anchor" href="#data-qc"></a>
</h3>
<p>The goal of this step is to assess if the normalization applied to
the input ADAT is appropriate for the study. To accomplish this, we can
check the association of normalization scale factors with any
<em>endpoint</em> of interest.</p>
<p>As an example, we will create a <code>status_class</code> two-group
endpoint variable and a <code>status_cont</code> continuous endpoint
variable in the <code>filt_data</code> ADAT.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create "status" endpoints as examples</span></span>
<span><span class="va">filt_data</span> <span class="op">&lt;-</span> <span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span><span class="fl">101</span>,</span>
<span>  <span class="va">filt_data</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>status_cont <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">filt_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>status_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">status_cont</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="st">"treatment"</span>, <span class="st">"control"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Plot the normalization scale factors by the <code>status_class</code>
endpoint.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filt_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">SampleId</span>, <span class="va">status_class</span>, <span class="fu">all_of</span><span class="op">(</span><span class="va">norm_vars</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">SampleId</span>, <span class="va">status_class</span><span class="op">)</span>,</span>
<span>                      names_to <span class="op">=</span> <span class="st">"Normalization Scale Factor"</span>,</span>
<span>                      values_to <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Normalization Scale Factor`</span>, y <span class="op">=</span> <span class="va">Value</span>, fill <span class="op">=</span> <span class="va">status_class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept  <span class="op">=</span> <span class="fl">0.4</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept  <span class="op">=</span> <span class="fl">2.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#4067E2"</span>, <span class="st">"#59CFDB"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures%2Fpre-processing-nsf-qc-class-plot-1.png" width="672" style="display: block; margin: auto;"></p>
<p>There does not appear to be any visual normalization bias by
<code>status_class</code>. This conclusion is confirmed by the results
from t-tests.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">norm_vars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">norm_vars</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">.x</span>, <span class="st">"~ status_class"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="co"># create formula</span></span>
<span>    t_test  <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">formula</span>, <span class="op">~</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">.x</span>, data <span class="op">=</span> <span class="va">filt_data</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># fit t-tests</span></span>
<span>    t_stat  <span class="op">=</span> <span class="fu">map_dbl</span><span class="op">(</span><span class="va">t_test</span>, <span class="st">"statistic"</span><span class="op">)</span>,            <span class="co"># pull out t-statistic</span></span>
<span>    p.value <span class="op">=</span> <span class="fu">map_dbl</span><span class="op">(</span><span class="va">t_test</span>, <span class="st">"p.value"</span><span class="op">)</span>,              <span class="co"># pull out p-values</span></span>
<span>    fdr     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p.value</span>, method <span class="op">=</span> <span class="st">"BH"</span><span class="op">)</span>         <span class="co"># FDR for multiple testing</span></span>
<span>  <span class="op">)</span> </span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 6</span></span></span>
<span><span class="co">#&gt;   value           formula   t_test  t_stat p.value   fdr</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> NormScale_20    <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #949494;">&lt;htest&gt;</span>  0.604   0.547 0.585</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> NormScale_0_005 <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #949494;">&lt;htest&gt;</span> -<span style="color: #BB0000;">1.58</span>    0.117 0.351</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> NormScale_0_5   <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #949494;">&lt;htest&gt;</span> -<span style="color: #BB0000;">0.548</span>   0.585 0.585</span></span></code></pre></div>
<p>Now, check for normalization bias by the continuous endpoint
<code>status_cont</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filt_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">SampleId</span>, <span class="va">status_cont</span>, <span class="fu">all_of</span><span class="op">(</span><span class="va">norm_vars</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">SampleId</span>, <span class="va">status_cont</span><span class="op">)</span>,</span>
<span>                      names_to <span class="op">=</span> <span class="st">"Normalization Scale Factor"</span>,</span>
<span>                      values_to <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">status_cont</span>, y <span class="op">=</span> <span class="va">Value</span>, color <span class="op">=</span> <span class="va">`Normalization Scale Factor`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept  <span class="op">=</span> <span class="fl">0.4</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept  <span class="op">=</span> <span class="fl">2.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#4067E2"</span>, <span class="st">"#59CFDB"</span>, <span class="st">"#DB40EF"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">`Normalization Scale Factor`</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures%2Fpre-processing-nsf-qc-cont-plot-1.png" width="672" style="display: block; margin: auto;"></p>
<p>There does not appear to be any visual normalization bias by the
<code>status_cont</code> continuous endpoint. This conclusion is
confirmed by the results from correlation tests.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">norm_vars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">norm_vars</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"~ status_cont +"</span>, <span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="co"># create formula</span></span>
<span>    cor     <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">formula</span>, <span class="op">~</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">.x</span>, data <span class="op">=</span> <span class="va">filt_data</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># calculate correlations</span></span>
<span>    pearson <span class="op">=</span> <span class="fu">map_dbl</span><span class="op">(</span><span class="va">cor</span>, <span class="st">"statistic"</span><span class="op">)</span>,            <span class="co"># pull out test statistic</span></span>
<span>    p.value <span class="op">=</span> <span class="fu">map_dbl</span><span class="op">(</span><span class="va">cor</span>, <span class="st">"p.value"</span><span class="op">)</span>,              <span class="co"># pull out p-values</span></span>
<span>    fdr     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p.value</span>, method <span class="op">=</span> <span class="st">"BH"</span><span class="op">)</span>      <span class="co"># FDR for multiple testing</span></span>
<span>  <span class="op">)</span> </span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 6</span></span></span>
<span><span class="co">#&gt;   value           formula   cor     pearson p.value   fdr</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> NormScale_20    <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #949494;">&lt;htest&gt;</span>   0.132   0.895 0.895</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> NormScale_0_005 <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #949494;">&lt;htest&gt;</span>   0.674   0.501 0.853</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> NormScale_0_5   <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #949494;">&lt;htest&gt;</span>   0.571   0.569 0.853</span></span></code></pre></div>
<p>If there <em>is</em> a considerable normalization bias observed in
your ADAT, an alternate normalization should be used for univariate
analyses, and any planned analyses may need to be modified to account
for this bias.</p>
<hr>
</div>
<div class="section level3">
<h3 id="transformations">Transformations<a class="anchor" aria-label="anchor" href="#transformations"></a>
</h3>
<p>SomaScan data is typically delivered to end users as normalized,
untransformed RFUs. Many analytic operations are best performed using
these untransformed values, including fold-change calculations, <a href="https://somalogic.github.io/SomaDataIO/articles/lifting-and-bridging.html">bridging
RFUs across assay versions</a>, calculating coefficients of variation
(CV) for replicate samples, and comparing study-specific RFUs to
population reference values provided in the <a href="https://somalogic.com/somascan-menu/" class="external-link">SomaScan Menu Tool</a>.</p>
<p>While many operations are conducted on untransformed RFU values, it
is important to note that for each SeqId, the distribution of biological
sample RFUs generally follows a right-tailed, log-normal distribution.
Let’s take a look at the distribution of one example analyte feature,
<code>seq.10023.32</code>, before any transformations are applied.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filt_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">seq.10023.32</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#59CFDB"</span>, color <span class="op">=</span> <span class="st">"#59CFDB"</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures%2Fpre-processing-untransformed-dist-1.png" width="672" style="display: block; margin: auto;"></p>
<p>There is a log-normal distribution, with a long right-tail in the
distribution of raw RFU values, and this is the assumed distribution of
untransformed analytes provided in an ADAT file.</p>
<div class="section level4">
<h4 id="log-10">Log-10<a class="anchor" aria-label="anchor" href="#log-10"></a>
</h4>
<p>Performing a log10 transformation is recommended prior to using
methods that assume normally distributed measurements. Please note that
real-world data rarely conforms exactly to ideal distributional
assumptions and analysts should feel free to explore alternative
transformations that may better suit their specific data and statistical
test assumptions. However, we have found that the log10 transformation
is broadly appropriate for standard parametric analyses across the
SomaScan menu.</p>
<p>The <code>SomaDataIO</code> package provides a <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10()</a></code>
math generic function for the <code>soma_adat</code> class, which will
log-10 transform all SOMAmer analyte features within an ADAT file.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filt_data</span> <span class="op">&lt;-</span> <span class="va">filt_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level4">
<h4 id="centering-and-scaling-z-score">Centering and Scaling (Z-Score)<a class="anchor" aria-label="anchor" href="#centering-and-scaling-z-score"></a>
</h4>
<p>A further transformation to consider applying to the analyte features
is a Z-score transformation if your experiment includes any multivariate
analysis. To compare relative differential signal across analyte
features, centering and scaling all of the RFU values should be applied
through a Z-score transformation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><mfrac><mrow><mi>x</mi><mo>−</mo><mi>μ</mi></mrow><mi>σ</mi></mfrac></mrow><annotation encoding="application/x-tex">
Z = \frac{x - \mu}{\sigma}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
is the observed value,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>,
is the mean of the sample, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
is the standard deviation of the sample. The z-score transformation is
typically performed on log10-transformed RFUs.</p>
<p>This can be done by creating a simple function,
<code>center_scale()</code>, and applying it to all analytes in
<code>filt_data</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># center/scale</span></span>
<span><span class="va">center_scale</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">{</span>    <span class="co"># .x = numeric vector</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">.x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>  <span class="co"># center</span></span>
<span>  <span class="va">out</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span>         <span class="co"># scale</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">filt_data</span> <span class="op">&lt;-</span> <span class="va">filt_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu"><a href="../reference/getAnalytes.html">getAnalytes</a></span><span class="op">(</span><span class="va">filt_data</span><span class="op">)</span>, <span class="va">center_scale</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now, re-examine the distribution of the same analyte feature
<code>seq.10023.32</code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filt_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">seq.10023.32</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#59CFDB"</span>, color <span class="op">=</span> <span class="st">"#59CFDB"</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures%2Fpre-processing-transformed-dist-1.png" width="672" style="display: block; margin: auto;"></p>
<p>After applying the transformations, the distribution of all of the
pre-processed analyte features should look similar to the above. If true
modal behavior of any analytes are observed, it may require secondary
assessment and further evaluation.</p>
<p>While centering and scaling standardizes the RFU distributions across
all SeqIds for multivariate analysis, it is important to understand that
this does <em>not</em> enable meaningful comparison of expression values
between different SeqIds. Take, for instance, hypothetical SeqId A with
a z-score of 2 and hypothetical SeqId B with a z-score of -1. One cannot
infer that the protein target of SeqId A was present at a higher
concentration than the target of SeqId B in the original sample prep.
All comparisons should be made between sample groups <em>within</em> a
given SeqId. The RFU value, as well as log10 RFU and z-score, is
dependent on variety of analyte-specific factors such as the SOMAmer
Reagent-target protein binding kinetics, the dilution bin of the SOMAmer
reagant, NHS-biotin conjagation efficiency of the SOMAmer, and other
factors intrinsic to the SOMAmer Reagent within the SomaScan assay.</p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="preprocessadat-function">
<code>preProcessAdat()</code> function<a class="anchor" aria-label="anchor" href="#preprocessadat-function"></a>
</h3>
<p>The <code><a href="../reference/preProcessAdat.html">preProcessAdat()</a></code> function is available to perform
the steps outlined in this vignette. By default, it will filter features
and samples using the standard QC and normalization acceptance criteria
described earlier, but <em>will not</em> drop sample-level RFU outliers.
It also has the option to perform log-10 and center &amp; scale
transformations to the untransformed RFU values. If data QC plots by
endpoints or clinical variables are desired,the names of the variables
should be explicitly passed to the <code>data.qc</code> argument. Please
see the <code><a href="../reference/preProcessAdat.html">preProcessAdat()</a></code> function documentation for more
details.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first recreate outlier and endpoints, and add to original example_data object</span></span>
<span><span class="va">apts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getAnalytes.html">getAnalytes</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">)</span></span>
<span><span class="va">example_data</span><span class="op">[</span><span class="fl">12</span>, <span class="va">apts</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">600</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">example_data</span><span class="op">[</span><span class="fl">12</span>, <span class="va">apts</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">600</span><span class="op">]</span><span class="op">]</span> <span class="op">*</span> <span class="fl">100</span>  <span class="co"># 600 apts ~ 12%</span></span>
<span></span>
<span><span class="va">example_data</span> <span class="op">&lt;-</span> <span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span><span class="fl">101</span>,</span>
<span>  <span class="va">example_data</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>status_cont  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>status_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">status_cont</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="st">"treatment"</span>, <span class="st">"control"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">processed_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preProcessAdat.html">preProcessAdat</a></span><span class="op">(</span>adat            <span class="op">=</span> <span class="va">example_data</span>,</span>
<span>                                 filter.features <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 filter.controls <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 filter.qc       <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 filter.outliers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                 data.qc         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"status_class"</span>,</span>
<span>                                                     <span class="st">"status_cont"</span><span class="op">)</span>,</span>
<span>                                 log.10          <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                 center.scale    <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">305</span> non-human protein features were removed.</span></span>
<span><span class="co">#&gt; → <span style="color: #0000BB;">214</span> human proteins did not pass standard QC</span></span>
<span><span class="co">#&gt; acceptance criteria and were flagged in `ColCheck`.  These features</span></span>
<span><span class="co">#&gt; were not removed, as they still may yield useful information in an</span></span>
<span><span class="co">#&gt; analysis, but further evaluation may be needed.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">6</span> buffer samples were removed.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">10</span> calibrator samples were removed.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">6</span> QC samples were removed.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">2</span> samples flagged in `RowCheck` did not</span></span>
<span><span class="co">#&gt; pass standard normalization acceptance criteria (0.4 &lt;= x &lt;= 2.5)</span></span>
<span><span class="co">#&gt; and were removed.</span></span>
<span><span class="co">#&gt; → Data QC plots were generated:</span></span>
<span><span class="co">#&gt; $status_class</span></span></code></pre></div>
<p><img src="figures%2Fpre-processing-full-preProcessAdat-1.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $status_cont</span></span></code></pre>
<p><img src="figures%2Fpre-processing-full-preProcessAdat-2.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">processed_data</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">══</span> <span style="font-weight: bold;">SomaScan Data</span> <span style="color: #0000BB;">══════════════════════════════════════════════════════</span></span></span>
<span><span class="co">#&gt;      SomaScan version     <span style="color: #00BBBB;">V4 (5k)</span></span></span>
<span><span class="co">#&gt;      Signal Space         <span style="color: #00BBBB;">5k</span></span></span>
<span><span class="co">#&gt;      Attributes intact    <span style="color: #00BB00;">✓</span></span></span>
<span><span class="co">#&gt;      Rows                 <span style="color: #00BBBB;">168</span></span></span>
<span><span class="co">#&gt;      Columns              <span style="color: #00BBBB;">5015</span></span></span>
<span><span class="co">#&gt;      Clinical Data        <span style="color: #00BBBB;">36</span></span></span>
<span><span class="co">#&gt;      Features             <span style="color: #00BBBB;">4979</span></span></span>
<span><span class="co">#&gt; <span style="color: #BB00BB;">──</span> <span style="font-weight: bold;">Column Meta</span> <span style="color: #BB00BB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> SeqId, SeqIdVersion, SomaId, TargetFullName, Target,</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> UniProt, EntrezGeneID, EntrezGeneSymbol, Organism, Units,</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Type, Dilution, PlateScale_Reference, CalReference,</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Cal_Example_Adat_Set001, ColCheck,</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> CalQcRatio_Example_Adat_Set001_170255, QcReference_170255,</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Cal_Example_Adat_Set002,</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> CalQcRatio_Example_Adat_Set002_170255, Dilution2</span></span>
<span><span class="co">#&gt; <span style="color: #BB00BB;">──</span> <span style="font-weight: bold;">Tibble</span> <span style="color: #BB00BB;">─────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 168 × 5,016</span></span></span>
<span><span class="co">#&gt;    row_names      PlateId  PlateRunDate ScannerID PlatePosition SlideId</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 258495800012_3 Example… 2020-06-18   SG152144… H9            2.58<span style="color: #949494;">e</span>11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 258495800004_7 Example… 2020-06-18   SG152144… H8            2.58<span style="color: #949494;">e</span>11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 258495800010_8 Example… 2020-06-18   SG152144… H7            2.58<span style="color: #949494;">e</span>11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 258495800003_4 Example… 2020-06-18   SG152144… H6            2.58<span style="color: #949494;">e</span>11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 258495800009_4 Example… 2020-06-18   SG152144… H5            2.58<span style="color: #949494;">e</span>11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 258495800012_8 Example… 2020-06-18   SG152144… H4            2.58<span style="color: #949494;">e</span>11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 258495800001_3 Example… 2020-06-18   SG152144… H3            2.58<span style="color: #949494;">e</span>11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 258495800004_8 Example… 2020-06-18   SG152144… H2            2.58<span style="color: #949494;">e</span>11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 258495800001_8 Example… 2020-06-18   SG152144… H12           2.58<span style="color: #949494;">e</span>11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 258495800009_8 Example… 2020-06-18   SG152144… H10           2.58<span style="color: #949494;">e</span>11</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 158 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5,010 more variables: Subarray &lt;dbl&gt;, SampleId &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   SampleType &lt;chr&gt;, PercentDilution &lt;int&gt;, SampleMatrix &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Barcode &lt;lgl&gt;, Barcode2d &lt;chr&gt;, SampleName &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   SampleNotes &lt;lgl&gt;, AliquotingNotes &lt;lgl&gt;, …</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">═══════════════════════════════════════════════════════════════════════</span></span></span></code></pre></div>
<hr>
</div>
<div class="section level3">
<h3 id="questions">Questions<a class="anchor" aria-label="anchor" href="#questions"></a>
</h3>
<p>As always, if you have any pre-processing questions, we are here to
help. Please reach out to us via:</p>
<ul>
<li>GitHub <a href="https://somalogic.github.io/SomaDataIO/SUPPORT.html">SUPPORT</a>
</li>
<li>Global Scientific Engagement Team: <a href="mailto:techsupport@somalogic.com" class="email">techsupport@somalogic.com</a>
</li>
<li>General SomaScan inquiries: <a href="mailto:support@somalogic.com" class="email">support@somalogic.com</a>
</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p><img src="../favicon-16x16.png"> SomaDataIO was developed by the Bioinformatics Dept. at <a href="http://www.standardbio.com" class="external-link">Standard BioTools, Inc.</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer>
</body>
</html>
